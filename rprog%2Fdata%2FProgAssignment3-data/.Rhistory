data_final <- arrange(data_split, Hospital.30.Day.Death..Mortality..Rates.from.Pneumonia)
}
else if(num == "worst"){
data_final <- arrange(data_split, desc(Hospital.30.Day.Death..Mortality..Rates.from.Pneumonia))
}
else{
data_final <- arrange(data_split, Hospital.30.Day.Death..Mortality..Rates.from.Pneumonia)
}
}
else if(outcome == 'heart attack')
{
if(num == "best"){
data_final <- arrange(data_split, Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack)
}
else if(num == "worst"){
data_final <- arrange(data_split, desc(Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack))
}
else{
data_final <- arrange(data_split, desc(Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack))
}
}
if(num == "best" || num == "worst"){
vector_hospital <- data_final[,2]
return(vector_hospital[1])
}
return(data_final[num, 2])
}
}
rankhospital("WA", "heart attack", 7)
rankhospital1<- function(state, outcome, num = "best")
{
outcome1 <- read.csv("outcome-of-care-measures.csv",
colClasses = "character")
if(!any(state == outcome1$State)){
stop("invalid state")}
else if((outcome %in% c("heart attack", "heart failure",
"pneumonia")) == FALSE) {
stop(print("invalid outcome"))
}
outcome2 <- subset(outcome1, State == state)
if (outcome == "heart attack") {
colnum <- 11
}
else if (outcome == "heart failure") {
colnum <- 17
}
else {
colnum <- 23
}
outcome2[ ,colnum] <- as.numeric(outcome2[ ,colnum])
outcome3 <- outcome2[order(outcome2[ ,colnum],outcome2[,2]), ]
outcome3 <- outcome3[(!is.na(outcome3[ ,colnum])),]
if(num == "best"){
num <- 1
}
else if (num == "worst"){
num <- nrow(outcome3)
}
return(outcome3[num,2])
}
rankhospital("WA", "heart attack", 7)
rankhospital1("WA", "heart attack", 7)
debug(rankhospital)
rankhospital("WA", "heart attack", 7)
View(data_final)
rankhospital <- function(state, outcome, num = "best") {
data_outcome <- read.csv("outcome-of-care-measures.csv", na.strings = "Not Available")
data_split <- subset(data_outcome, data_outcome$State == state,  is.na(NA) == "TRUE")
if(outcome == 'heart attack' || outcome =='pneumonia' || outcome == 'heart failure')
{
if(outcome == 'pneumonia')
{
if(num == "best"){
data_final <- arrange(data_split, Hospital.30.Day.Death..Mortality..Rates.from.Pneumonia)
}
else if(num == "worst"){
data_final <- arrange(data_split, desc(Hospital.30.Day.Death..Mortality..Rates.from.Pneumonia))
}
else{
data_final <- arrange(data_split, Hospital.30.Day.Death..Mortality..Rates.from.Pneumonia)
}
}
else if(outcome == 'heart attack')
{
if(num == "best"){
data_final <- arrange(data_split, Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack)
}
else if(num == "worst"){
data_final <- arrange(data_split, desc(Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack))
}
else{
data_final <- arrange(data_split, (Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack))
}
}
if(num == "best" || num == "worst"){
vector_hospital <- data_final[,2]
return(vector_hospital[1])
}
return(data_final[num, 2])
}
}
nn
debug(rankhospital)
rankhospital("WA", "heart attack", 7)
View(data_final)
rankhospital <- function(state, outcome, num = "best") {
data_outcome <- read.csv("outcome-of-care-measures.csv", na.strings = "Not Available")
data_split <- subset(data_outcome, data_outcome$State == state,  is.na(NA) == "TRUE")
if(outcome == 'heart attack' || outcome =='pneumonia' || outcome == 'heart failure')
{
if(outcome == 'pneumonia')
{
if(num == "best"){
data_final <- arrange(data_split, Hospital.30.Day.Death..Mortality..Rates.from.Pneumonia)
}
else if(num == "worst"){
data_final <- arrange(data_split, desc(Hospital.30.Day.Death..Mortality..Rates.from.Pneumonia))
}
else{
data_final <- arrange(data_split, Hospital.30.Day.Death..Mortality..Rates.from.Pneumonia)
}
}
else if(outcome == 'heart attack')
{
if(num == "best"){
data_final <- arrange(data_split, Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack)
}
else if(num == "worst"){
data_final <- arrange(data_split, desc(Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack))
}
else{
data_final <- arrange(data_split, (Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack))
}
}
if(num == "best" || num == "worst"){
vector_hospital <- data_final[,2]
return(vector_hospital[1])
}
return(data_final[num, 2])
}
}
rankhospital("WA", "heart attack", 7)
rankhospital("TX", "pneumonia", 10)
rankhospital1("TX", "pneumonia", 10)
rankhospital("NY", "heart attack", 7)
rankhospital1("NY", "heart attack", 7)
debug(rankhospital)
rankhospital1("NY", "heart attack", 7)
rankhospital("NY", "heart attack", 7)
View(data_final)
View(data_final)
data_outcome <- read.csv("outcome-of-care-measures.csv", na.strings = "Not Available")
data_split<- split(data_outcome, data_outcome$State, is.na(NA) == "TRUE")
View(data_split)
class(data_split)
data_split$AK
data_split[1]$State
data_split[[1]]$State
data_split[[[1]]$State
data_split[[[1]]$State
data_split[[[[1]]]$State
data_split[[[1]]]$State
for(i in data_split){
vector_state[i] <- data_split$State
}
for(i in data_split){
vector_state <- data_split$State
}
vector_state <- data_split[[1]]
View(vector_state)
valu <- vector_state$State
valu
valu <- vector_state$State[1]
valu
for(i in data_split){
vector_state <- data_split[[i]]
Hospital_name[i] <- rankhospital1(vector_state$State, outcome, num = best)
}
for(i in length(data_split)){
vector_state <- data_split[[i]]
Hospital_name[i] <- rankhospital1(vector_state$State, outcome, num = best)
}
for(i in length(data_split)){
vector_state <- data_split[[i]]
Hospital_name[i] <- rankhospital1(vector_state$State, "heart attack", num = best)
}
vector_state <- data_split[[1]]
str(vector_state)
vc <- vector_state[,7]
vc
vc <- vc[1]
vc
length(vc)
Hospital_name <- rankhospital1(vc, "heart attack", num = best)
Hospital_name <- rankhospital1("vc", "heart attack", best)
Hospital_name <- rankhospital1("vc", "heart attack", "best")
Hospital_name <- rankhospital1("vc[1]", "heart attack", "best")
vc
vc[1]
Hospital_name <- rankhospital("vc[1]", "heart attack", "best")
m
Hospital_name <- rankhospital(vc[1], "heart attack", "best")
View(data_split)
rankall <-  function(outcome, num = "best") {
data_outcome <- read.csv("outcome-of-care-measures.csv", na.strings = "Not Available")
data_split<- split(data_outcome, data_outcome$State, is.na(NA) == "TRUE")
Hospital_name <- C()
State_name <- C()
for(i in length(data_split)){
vector_state <- data_split[[i]]
vc <- vector_state[,7]
vc <- vc[1]
Hospital_name[i] <- rankhospital1(vc, outcome, num)
State_name[i] <- vc
}
## Read outcome data
## For each state, find the hospital of the given rank
## Return a data frame with the hospital names and the (abbreviated)
## state name
}
rankall <-  function(outcome, num = "best") {
data_outcome <- read.csv("outcome-of-care-measures.csv", na.strings = "Not Available")
data_split<- split(data_outcome, data_outcome$State, is.na(NA) == "TRUE")
Hospital_name <- C()
State_name <- C()
for(i in length(data_split)){
vector_state <- data_split[[i]]
vc <- vector_state[,7]
vc <- vc[1]
Hospital_name[i] <- rankhospital1(vc, outcome, num)
State_name[i] <- vc
}
cbind(Hospital_name, State_name)
## Read outcome data
## For each state, find the hospital of the given rank
## Return a data frame with the hospital names and the (abbreviated)
## state name
}
r <- rankall("pneumonia", "worst")
debug(rankall)
r <- rankall("pneumonia", "worst")
rankall <-  function(outcome, num = "best") {
data_outcome <- read.csv("outcome-of-care-measures.csv", na.strings = "Not Available")
data_split<- split(data_outcome, data_outcome$State, is.na(NA) == "TRUE")
for(i in length(data_split)){
vector_state <- data_split[[i]]
vc <- vector_state[,7]
vc <- vc[1]
Hospital_name[i] <- rankhospital1(vc, outcome, num)
State_name[i] <- vc
}
cbind(Hospital_name, State_name)
## Read outcome data
## For each state, find the hospital of the given rank
## Return a data frame with the hospital names and the (abbreviated)
## state name
}
r <- rankall("pneumonia", "worst")
rankall <-  function(outcome, num = "best") {
data_outcome <- read.csv("outcome-of-care-measures.csv", na.strings = "Not Available")
data_split<- split(data_outcome, data_outcome$State, is.na(NA) == "TRUE")
for(i in length(data_split)){
vector_state <- data_split[[i]]
vc <- vector_state[,7]
vc <- vc[1]
Hospital_name <- rankhospital1(vc, outcome, num)
State_name <- vc
}
cbind(Hospital_name, State_name)
## Read outcome data
## For each state, find the hospital of the given rank
## Return a data frame with the hospital names and the (abbreviated)
## state name
}
r <- rankall("pneumonia", "worst")
r
debug(rankall)
r <- rankall("pneumonia", "worst")
View(r)
rankall <-  function(outcome, num = "best") {
data_outcome <- read.csv("outcome-of-care-measures.csv", na.strings = "Not Available")
data_split<- split(data_outcome, data_outcome$State, is.na(NA) == "TRUE")
while(i < length(data_split)){
vector_state <- data_split[[i]]
vc <- vector_state[,7]
vc <- vc[1]
Hospital_name <- rankhospital1(vc, outcome, num)
State_name <- vc
}
cbind(Hospital_name, State_name)
## Read outcome data
## For each state, find the hospital of the given rank
## Return a data frame with the hospital names and the (abbreviated)
## state name
}
debug(rankall)
r <- rankall("pneumonia", "worst")
length(data_split)
rankall <-  function(outcome, num = "best") {
data_outcome <- read.csv("outcome-of-care-measures.csv", na.strings = "Not Available")
data_split<- split(data_outcome, data_outcome$State, is.na(NA) == "TRUE")
i = 0
while(i < length(data_split)){
vector_state <- data_split[[i]]
vc <- vector_state[,7]
vc <- vc[1]
Hospital_name <- rankhospital1(vc, outcome, num)
State_name <- vc
}
cbind(Hospital_name, State_name)
## Read outcome data
## For each state, find the hospital of the given rank
## Return a data frame with the hospital names and the (abbreviated)
## state name
}
debug(rankall)
r <- rankall("pneumonia", "worst")
rankall <-  function(outcome, num = "best") {
data_outcome <- read.csv("outcome-of-care-measures.csv", na.strings = "Not Available")
data_split<- split(data_outcome, data_outcome$State, is.na(NA) == "TRUE")
i = 1
while(i < length(data_split)){
vector_state <- data_split[[i]]
vc <- vector_state[,7]
vc <- vc[1]
Hospital_name <- rankhospital1(vc, outcome, num)
State_name <- vc
}
cbind(Hospital_name, State_name)
## Read outcome data
## For each state, find the hospital of the given rank
## Return a data frame with the hospital names and the (abbreviated)
## state name
}
debug(rankall)
r <- rankall("pneumonia", "worst")
m
nn
r <- rankall("pneumonia", "worst")
rankall <-  function(outcome, num = "best") {
data_outcome <- read.csv("outcome-of-care-measures.csv", na.strings = "Not Available")
data_split<- split(data_outcome, data_outcome$State, is.na(NA) == "TRUE")
i = 1
while(i < length(data_split)){
vector_state <- data_split[[i]]
vc <- vector_state[,7]
vc <- vc[1]
Hospital_name <- rankhospital1(vc, outcome, num)
State_name <- vc
i = i + 1
}
cbind(Hospital_name, State_name)
## Read outcome data
## For each state, find the hospital of the given rank
## Return a data frame with the hospital names and the (abbreviated)
## state name
}
r <- rankall("pneumonia", "worst")
r
rankall <-  function(outcome, num = "best") {
data_outcome <- read.csv("outcome-of-care-measures.csv", na.strings = "Not Available")
data_split<- split(data_outcome, data_outcome$State, is.na(NA) == "TRUE")
i = 1
while(i < length(data_split)){
vector_state <- data_split[[i]]
vc <- vector_state[,7]
vc <- vc[1]
Hospital_name[i] <- rankhospital1(vc, outcome, num)
State_name[i] <- vc
i = i + 1
}
cbind(Hospital_name, State_name)
## Read outcome data
## For each state, find the hospital of the given rank
## Return a data frame with the hospital names and the (abbreviated)
## state name
}
r <- rankall("pneumonia", "worst")
rankall <-  function(outcome, num = "best") {
data_outcome <- read.csv("outcome-of-care-measures.csv", na.strings = "Not Available")
data_split<- split(data_outcome, data_outcome$State, is.na(NA) == "TRUE")
i = 1
while(i < length(data_split)){
vector_state <- data_split[[i]]
vc <- vector_state[,7]
vc <- vc[1]
vector[i] <- rankhospital1(vc, outcome, num)
State_name[i] <- vc
i = i + 1
}
cbind(Hospital_name, State_name)
## Read outcome data
## For each state, find the hospital of the given rank
## Return a data frame with the hospital names and the (abbreviated)
## state name
}
r <- rankall("pneumonia", "worst")
rankall <-  function(outcome, num = "best") {
data_outcome <- read.csv("outcome-of-care-measures.csv", na.strings = "Not Available")
data_split<- split(data_outcome, data_outcome$State, is.na(NA) == "TRUE")
i = 1
vector = c()
while(i < length(data_split)){
vector_state <- data_split[[i]]
vc <- vector_state[,7]
vc <- vc[1]
vector[i] <- rankhospital1(vc, outcome, num)
State_name[i] <- vc
i = i + 1
}
cbind(Hospital_name, State_name)
## Read outcome data
## For each state, find the hospital of the given rank
## Return a data frame with the hospital names and the (abbreviated)
## state name
}
r <- rankall("pneumonia", "worst")
rankall <-  function(outcome, num = "best") {
data_outcome <- read.csv("outcome-of-care-measures.csv", na.strings = "Not Available")
data_split<- split(data_outcome, data_outcome$State, is.na(NA) == "TRUE")
i = 1
vector = c()
State_name = c()
while(i < length(data_split)){
vector_state <- data_split[[i]]
vc <- vector_state[,7]
vc <- vc[1]
vector[i] <- rankhospital1(vc, outcome, num)
State_name[i] <- vc
i = i + 1
}
cbind(Hospital_name, State_name)
## Read outcome data
## For each state, find the hospital of the given rank
## Return a data frame with the hospital names and the (abbreviated)
## state name
}
r <- rankall("pneumonia", "worst")
as.character(subset(r, state == "NV")$hospital)
r
rankall <-  function(outcome, num = "best") {
data_outcome <- read.csv("outcome-of-care-measures.csv", na.strings = "Not Available")
data_split<- split(data_outcome, data_outcome$State, is.na(NA) == "TRUE")
i = 1
vector = c()
State_name = c()
while(i < length(data_split)){
vector_state <- data_split[[i]]
vc <- vector_state[,7]
vc <- vc[1]
vector[i] <- rankhospital1(vc, outcome, num)
State_name[i] <- vc
i = i + 1
}
vector
## Read outcome data
## For each state, find the hospital of the given rank
## Return a data frame with the hospital names and the (abbreviated)
## state name
}
r <- rankall("pneumonia", "worst")
r
rankall1<- function(outcome, num = "best")
{
library(dplyr)
library(magrittr)
outcome2 <- read.csv("outcome-of-care-measures.csv",
colClasses = "character")
if((outcome %in% c("heart attack", "heart failure",
"pneumonia")) == FALSE) {
stop(print("invalid outcome"))
}
if (outcome == "heart attack") {
colnum <- 11
}
else if (outcome == "heart failure") {
colnum <- 17
}
else {
colnum <- 23
}
outcome2[ ,colnum] <- as.numeric(outcome2[ ,colnum])
outcome2 = outcome2[!is.na(outcome2[,colnum]),]
splited = split(outcome2, outcome2$State)
ans = lapply(splited, function(x, num) {
x = x[order(x[,colnum], x$Hospital.Name),]
if(class(num) == "character") {
if(num == "best") {
return (x$Hospital.Name[1])
}
else if(num == "worst") {
return (x$Hospital.Name[nrow(x)])
}
}
else {
return (x$Hospital.Name[num])
}
}, num)
#Return data.frame with format
return ( data.frame(hospital=unlist(ans), state=names(ans)) )
}
# example output:
r <- rankall("heart attack", 4)
as.character(subset(r, state == "HI")$hospital)
r <- rankall1("pneumonia", "worst")
as.character(subset(r, state == "NJ")$hospital)
r <- rankall1("heart failure", 10)
as.character(subset(r, state == "NV")$hospital)
install_from_swirl("Getting and Cleaning Data")
library(swirl)
install_from_swirl("Getting and Cleaning Data")
swirl()
